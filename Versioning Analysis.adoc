[[Versioning_in_Legacy_CDB]]

:figure-caption: Figure Versioning -
:figure-num: 0

[%hardbreaks]
= CDB Versioning, old and new

== An analysis of how 'versioning' is used in legacy OGC CDB 1.X, and how that experience leads to use cases for exploration of versioning in CDB X.

From the beginning of the development of CDB the concept of versioning was designed to support the development and distribution of "small changes" and to support end-site CDB servers' capability to link each dataset called a CDB to a 'parent' CDB dataset using the Versions.xml file in the Metadata subdirectory under the CDB-dataset top level directory.

The specific mechanism that enables versioning in OGC CDB 1.x is the XML element:  <PreviousIncrementalRootDirectory name=    >

The figure below, courtesy of Presagis / Hermann Brassard, shows a Version.xml file in a CDB with top-level directory named 'CDB_V1' pointing to a parent CDB top-level directory named 'CDB':

[#img_Presagis CDB Versioning Explanation Slide,reftext='{figure-caption} {counter:figure-num}']
.Versioning graphic, please disregard the number blocks from this re-used slide.+
image::Images/Presagis Versioning Presentation slide.jpg[width=800,align="center"]

OGC CDB's old versioning scheme relies on simulation clients to start looking for any file at the 'bottom' of the hierarchy of CDB datasets available on the server and linked by metadata.  Since simulation clients know in advance 'where they are' and 'where they want to go' a file search starts with a location.  Because of the rigid directory and file naming structure of CDB, a simulation client knows where to look for any file and what the file, if present, will be named. In the example above, the simulation client would start looking in CDB_V1.  In this example, CDB_V1 contains only a single file, a .tif file for N31 E065 Elevation at L00 and U0.  If the simulation client is looking for anything else, it will fail to find the file it is looking for, look at version.xml, find the 'PreviousIncrementalRootDirectory' (if any), and look again for the file in the next higher level CDB dataset in the hierarchy.

The existing requirement is that each CDB can point to 'none' or 'one-and-only-one' parent directory, so that the search tree for the files is deterministic.

In practical use CDB servers at simulation end-sites may not be managed by experts in database architecture.  CAE and other vendors will have developed utilities that allow a local or remote utility to be used to create the layout or 'chain'of CDB datasets that are present on a CDB server.

The slide below is a screen shot of a utility called the CAE CDB Update Manager Client, running on a CDB Server, that is part of a CDB simulation demonstration hosted on three laptop computers of about 2012 vintage.  The first image is the laptop computer hardware, the second image is the current chain of versions at the time of the screenshot.

[#img_CAE DSE 2012 Laptop Hardware,reftext='{figure-caption} {counter:figure-num}']
.CDB Laptop Simulation Demonstration Hardware+
image::Images/CAE DSE 2012 Demonstration Laptops.jpg[width=800,align="center"]

[#img_Presagis CDB Versioning Explanation Slide,reftext='{figure-caption} {counter:figure-num}']
.Versioning graphic, please disregard the number blocks from this re-used slide.+
image::Images/Presagis Versioning Presentation slide.jpg[width=800,align="center"]
